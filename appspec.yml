version: 0.0
os: linux

files:
  - source: /
    destination: /home/ubuntu/marketforge

hooks:
  BeforeInstall:
    # 1. SahipliÄŸi ayarla
    - location: scripts/change_ownership.sh
      timeout: 300
      runas: root

    # ğŸ’¥ YENÄ°: node_modules klasÃ¶rÃ¼nÃ¼ root olarak sil.
    - location: scripts/remove_node_modules.sh
      timeout: 300
      runas: root # Bu, kesinlikle root yetkisiyle Ã§alÄ±ÅŸmalÄ±.

    # Mevcut before_install.sh betiÄŸiniz (eÄŸer varsa)
    # - location: scripts/before_install.sh
    #   timeout: 300

  AfterInstall:
    # 2. Kurulumu yap: Bu betik iÃ§indeki sudo ile Ã§alÄ±ÅŸacak.
    - location: scripts/after_install.sh
      timeout: 300
      runas: ubuntu # Bu kullanÄ±cÄ± sudo yetkisi kullanacak.

  ApplicationStart:
    # 3. Sunucuyu baÅŸlat: npm install burada OLMAMALI!
    - location: scripts/start_server.sh
      timeout: 300
      runas: ubuntu
